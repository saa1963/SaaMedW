<Window x:Class="SaaMedW.EditZakazView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SaaMedW"
        mc:Ignorable="d"
        WindowStartupLocation="CenterScreen"
        Title="Заказ" Height="600" Width="1000">
    <Window.Resources>
        <local:VisibilityToBoolConverter x:Key="VisibilityToBoolConverter" />
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition></RowDefinition>
        </Grid.RowDefinitions>
        <Menu Grid.Row="0">
            <MenuItem Header="Комплект"></MenuItem>
            <MenuItem Header="Договор"></MenuItem>
            <MenuItem Header="Согласие"></MenuItem>
            <MenuItem Header="Медкарта"></MenuItem>
            <MenuItem Header="Заказ"></MenuItem>
            <MenuItem Header="Квитанция"></MenuItem>
            <MenuItem Header="Оплатить"></MenuItem>
            <MenuItem Header="Возврат"></MenuItem>
        </Menu>
        <WrapPanel Grid.Row="1">
            <StackPanel VerticalAlignment="Bottom">
                <Label Margin="10, 10, 10, 0" Content="Номер"></Label>
                <TextBox Margin="10, 0, 10, 10" Width="50" Text="{Binding Num}"></TextBox>
            </StackPanel>
            <StackPanel>
                <Label Margin="10, 10, 10, 0" Content="Дата"></Label>
                <DatePicker Margin="10, 0, 10, 10" SelectedDate="{Binding Dt}"></DatePicker>
            </StackPanel>
            <StackPanel Width="200">
                <Label Margin="10, 10, 10, 0" Content="Пациент"></Label>
                <ComboBox ItemsSource="{Binding PersonList}" 
                          DisplayMemberPath="FioBirthday" SelectedItem="{Binding Person}">
                </ComboBox>
            </StackPanel>
            <CheckBox Margin="10" Content="ДМС?" 
                      VerticalAlignment="Bottom" IsChecked="{Binding Dms}"></CheckBox>
            <StackPanel Orientation="Horizontal" Visibility="{Binding Dms, Converter={StaticResource VisibilityToBoolConverter}}">
                <StackPanel VerticalAlignment="Bottom">
                    <Label Margin="10, 10, 10, 0" Content="Полис"></Label>
                    <local:ClickSelectTextBox Margin="10, 0, 10, 10" 
                                              MaxLength="50"
                                              Text="{Binding Polis}"
                                              Width="100"></local:ClickSelectTextBox>
                </StackPanel>
                <StackPanel VerticalAlignment="Bottom">
                    <Label Margin="10, 10, 10, 0" Content="Компания"></Label>
                    <ComboBox Margin="10, 0, 10, 10" 
                              ItemsSource="{Binding DmsCompanyList}"
                              DisplayMemberPath="Name"
                              SelectedItem="{Binding DmsCompany}"
                              Width="200"></ComboBox>
                </StackPanel>
                <Button VerticalAlignment="Bottom" Margin="0, 0, 0, 10"
                Height="32" Width="32"
                Command="{Binding DmsCompanyClassificatorCommand}">
                    <Image Source="..\image\folder-open_32.png"></Image>
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="ToolTip" Value="Открыть справочник"></Setter>
                        </Style>
                    </Button.Style>
                </Button>
            </StackPanel>
        </WrapPanel>
        <Grid Margin="15,15,15,0" Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"></ColumnDefinition>
                <ColumnDefinition Width="Auto"></ColumnDefinition>
                <ColumnDefinition></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <DockPanel Grid.Column="0">
                <Label DockPanel.Dock="Top" Content="Все услуги"></Label>
                <TreeView Margin="0,0,10,0" Width="300" DockPanel.Dock="Top" 
                BorderBrush="Transparent"
                ItemsSource="{Binding SpecialtyList}">
                    <TreeView.ItemTemplate>
                        <HierarchicalDataTemplate ItemsSource="{Binding ChildSpecialties}">
                            <Border Margin="2">
                                <TextBlock Width="200" TextWrapping="Wrap">
                                <Run Text="- "></Run>
                                <Run Text="{Binding Name}"></Run>
                                </TextBlock>
                            </Border>
                        </HierarchicalDataTemplate>
                    </TreeView.ItemTemplate>
                </TreeView>
            </DockPanel>
            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <Button Margin="10" Command="{Binding AddBenefitCommand}">
                    <Image Source="../image/forward.png"></Image>
                </Button>
                <Button Margin="10" Command="{Binding RemoveBenefitCommand}">
                    <Image Source="../image/back.png"></Image>
                </Button>
            </StackPanel>
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="3*"></RowDefinition>
                    <RowDefinition></RowDefinition>
                </Grid.RowDefinitions>
                <DockPanel Grid.Row="0">
                    <Label DockPanel.Dock="Top" Content="Выбранные услуги (Кол. + Наименование)"></Label>
                    <DataGrid DockPanel.Dock="Top" ItemsSource="{Binding VisitBenefit}"
                        IsSynchronizedWithCurrentItem="True"
                        SelectedItem="{Binding SelectedBenefit2}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Наименование" Binding="{Binding Name}" Width="150"></DataGridTextColumn>
                            <DataGridComboBoxColumn Header="Врач" Width="100"></DataGridComboBoxColumn>
                            <DataGridTextColumn Header="Цена" Binding="{Binding Price, StringFormat={}{0:#0.00}}" Width="100"/>
                            <DataGridTextColumn Header="К-во" Binding="{Binding Kol, StringFormat={}{0:#0}}" Width="100"></DataGridTextColumn>
                            <DataGridTextColumn IsReadOnly="True" Header="Сумма" Binding="{Binding Sm, StringFormat={}{0:#0.00}}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </Grid>
        </Grid>
    </Grid>
</Window>
